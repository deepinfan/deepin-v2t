#!/bin/bash
# å®Œæ•´æµ‹è¯•è„šæœ¬ï¼ˆå¯ç”¨ DEBUG æ—¥å¿—ï¼‰

echo "ğŸ›‘ åœæ­¢ fcitx5..."
pkill -9 fcitx5
sleep 1

echo "ğŸš€ å¯åŠ¨ fcitx5ï¼ˆDEBUG æ¨¡å¼ï¼‰..."
echo ""
echo "âš ï¸  æµ‹è¯•è¯´æ˜ï¼š"
echo "   1. åˆ‡æ¢åˆ° V-Input è¾“å…¥æ³•"
echo "   2. æŒ‰ç©ºæ ¼å¼€å§‹å½•éŸ³"
echo "   3. è¯´è¯ç¤ºä¾‹ï¼ˆè¯ä¹‹é—´åœé¡¿ 0.5-1 ç§’ï¼‰ï¼š"
echo "      ä»Šå¤© [åœ] å¤©æ°” [åœ] å¾ˆå¥½ [åœ] æˆ‘æƒ³ [åœ] å‡ºå» [åœ] æ•£æ­¥"
echo "   4. æ¾å¼€ç©ºæ ¼åœæ­¢å½•éŸ³"
echo "   5. è§‚å¯Ÿè¯†åˆ«ç»“æœ"
echo "   6. æŒ‰ Ctrl+C åœæ­¢"
echo ""
echo "ğŸ“Š é…ç½®å·²åŠ è½½: pause_ratio=2.0, min_tokens=3"
echo "   é¢„æœŸ: åœé¡¿ > å¹³å‡æ—¶é•¿ Ã— 2.0 æ—¶æ’å…¥é€—å·"
echo ""
echo "å¼€å§‹ç›‘æ§..."
echo "============"
echo ""

# å¯åŠ¨ fcitx5 å¹¶è¿‡æ»¤å…³é”®æ—¥å¿—
VINPUT_LOG=debug fcitx5 2>&1 | tee /tmp/vinput-final-test.log | \
    grep -E "(Token\[|åœé¡¿æ£€æµ‹|æ£€æµ‹åˆ°åœé¡¿|å¤„ç† Token|å¥å°¾æ ‡ç‚¹)" --color=always
